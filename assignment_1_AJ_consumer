CREATE OR REPLACE TABLE AJ_CONSUMER
(
DATE_RECEIVED DATE,
PRODUCT_NAME VARCHAR(100),
SUB_PRODUCT VARCHAR (100),
ISSUE_ VARCHAR (1000),
SUB_ISSUE VARCHAR (1000),
Consumer_Complaint_Narrative VARCHAR(10000),
COMPANY_PUBLIC_RESPONSE VARCHAR(10000),
COMPANY VARCHAR(1000),
STATE_NAME VARCHAR(50),
ZIP_CODE VARCHAR,
TAGS_ VARCHAR(100),
CONSUMER_CONSENT_PROVIDED VARCHAR(500),
SUBMITTED_VIA VARCHAR(30),
DATE_SENT DATE,
COMPANY_RESPONSE_TO_CONSUMER VARCHAR(500),
TIMELY_RESPONSE VARCHAR(10),
CONSUMER_DISPUTED VARCHAR (10),
COMPLAINT_ID NUMBER
)
SELECT * FROM AJ_CONSUMER
create or replace VIEW CUSTOM_CONSUMER_COMPLAINTS_VIEW AS 
SELECT *, CONCAT(STATE_NAME,'-',ZIP_CODE) AS STATE_ZIP_DETAILS
FROM AJ_CONSUMER
WHERE SUB_ISSUE IS NOT NULL AND CONSUMER_COMPLAINT_NARRATIVE IS NOT NULL
AND SUB_PRODUCT IS NOT NULL
AND COMPANY_PUBLIC_RESPONSE IS NOT NULL;
SELECT * FROM AJ_CONSUMER

create or replace view CUSTUM_AJ_CONSUMER_VIEW AS
SELECT *, CONCAT(STATE_NAME, '-' , ZIP_CODE) AS STATE_ZIP_DETAILS
FROM AJ_CONSUMER
WHERE SUB_ISSUE IS NOT NULL OR CONSUMER_COMPLAINT_NARRATIVE IS NOT NULL
OR SUB_PRODUCT IS NOT NULL OR COMPANY_PUBLIC_RESPONSE IS NOT NULL
SELECT * FROM CUSTUM_AJ_CONSUMER_VIEW
